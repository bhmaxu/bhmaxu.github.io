<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.4"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.4"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><title>设计模式（1） | 马旭的博客</title><meta name="generator" content="Hexo 4.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">设计模式（1）</h1><a id="logo" href="/.">马旭的博客</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about-me/"><i class="fa fa-user"> About</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="search"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">设计模式（1）</h1><div class="post-meta"><a href="/2020/02/10/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%881%EF%BC%89/#comments" class="comment-count"></a><p><span class="date">Feb 10, 2020</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>Hits</i></i></span></p></div><div class="post-content"><p>​    这一系列是我学习设计模式过程中的总结与感受。当然许多人都说设计模式需要大量的实践才能真正学会，因此目前写下的一定是一些很粗浅的内容。在以后的开发过程中，我会进一步记录我对设计模式的体会。</p>
<p>​    这一篇文章包括策略模式和观察者模式。</p>
<h2 id="设计模式的意义"><a href="#设计模式的意义" class="headerlink" title="设计模式的意义"></a>设计模式的意义</h2><p>​    设计模式是历经验证的一系列OO设计经验、通用的解决方案。仅仅知道基础的OO概念如抽象、封装、继承、多态并不一定能设计出合理的系统。设计模式的目的在于提高系统的<strong>可复用、可扩充、可维护性</strong>。</p>
<h2 id="策略模式（Strategy-Pattern）"><a href="#策略模式（Strategy-Pattern）" class="headerlink" title="策略模式（Strategy Pattern）"></a>策略模式（Strategy Pattern）</h2><p><strong>定义</strong>：定义算法族，分别封装起来，让它们之间可以相互替换，此模式让算法的变化独立于使用算法的客户。</p>
<p>​    让我们考虑这样一个场景，假如有一个OO的父类和它的许多子类，在维护系统时，需要增加新功能，这一个新功能可能被许多子类公用，那么这个新功能应该写到哪里呢？如果考虑<strong>可复用性</strong>，似乎应该写成父类中的一个方法，那么子类就可以直接使用。但是这样有明显的缺点：我们不能确定所有的子类都用到这个方法，或是不能保证将来不会添加不需要该方法的子类，这样的代码不具有可维护性。那如果我们使用接口呢？把该新功能写成一个接口，让需要该方法的子类去实现，显然这样的方式也很蠢，因为代码完全无法复用，每个子类都需要去增加对应的代码。</p>
<p>​    我们需要一个原则来改进我们的代码——<strong>将代码中可能变化的地方独立出来，不要与固定不变的代码混在一起</strong>。根据这一原则，我们可以把永远不会变化的东西写入父类中，而可能实现的功能（策略模式定义中的算法族）从父类中分离出来。那么这些分离出来的可能变化的东西该如何实现呢？根据另一个原则——<strong>针对接口编程，而不是针对实现编程</strong>，我们可以想到一种聪明的方法，把一类相同的功能（算法）定义成一个接口（或JAVA中的抽象类，这里的接口只是一个粗略的说法），而功能的每一种具体实现（一族算法的每一个算法）在实现对应接口的单独的类中去实现。这样我们就不需要在原本的类中去硬编码一个算法的实现，只需要在<strong>运行中指定具体实现的对象</strong>（利用多态指定功能的某一个具体实现）。</p>
<p>​    总结策略模式的思想，我们不在一个类中硬编码功能的具体实现，而是声明为一个接口类型，在运行时再引用具体的实现，实现了之前提到的原则，不针对实现编程。而在运行时引用具体实现也有不同的方式，我们可以静态地在具体子类中直接指明需要的实现，也可以实现方法来动态指定，使我们的代码具有很强的<strong>可维护性和可扩充性</strong>。</p>
<p>​    总体上来看策略模式，我们实际上是把一个类和其他实现功能的类<strong>组合</strong>起来，避免了直接向父类继承的弊端。由此我们得到第三个原则——<strong>多用组合，少用继承</strong>。我们容易理解，继承实际上是将具体功能的实现<strong>硬编码</strong>，降低了系统的可维护性，而使用组合可以使系统具有很大的弹性，在运行时动态指定实现，只要实现符合对应的接口即可。</p>
<h2 id="观察者模式（Observer-Pattern）"><a href="#观察者模式（Observer-Pattern）" class="headerlink" title="观察者模式（Observer Pattern）"></a>观察者模式（Observer Pattern）</h2><p><strong>定义</strong>：定义了对象之间的一对多依赖，当一个对象的状态改变时，它的所有依赖者都会收到通知并自动更新。</p>
<p>​    我们可以设想一个观察者模式最简单的应用情况，有一个类会不定时产生数据（状态改变，如何改变我们并不关心），还有一系列的类需要实时得知新数据并做出相应。要实现上述功能，最简单的方式应该是产生数据的类在每次产生数据时主动调用其他依赖类的对应的响应的方法。但这种方式明显违背了之前<strong>针对接口编程，而不是针对实现编程</strong>的原则，我们也很容易想到，如果有新的类需要响应产生数据的类，我们甚至需要在核心的产生数据的类中去添加代码，原有的类取消响应或是响应的方法发生变化，也需要更改产生数据的类的代码，这样的系统显然不具有高<strong>可维护性</strong>，或者说，类之间具有很高的<strong>耦合</strong>。</p>
<p>​    那么观察者模式如何解决这个问题呢？实际上类似于订阅报纸的机制，每个住户需要报纸时，向邮局<strong>订阅</strong>，邮递员会在有新报纸时送到订阅的用户，如果不需要报纸，住户接触订阅即可。具体的说，观察者模式定义了两个接口：一个是Subject，对应之前提到的产生数据的类，这个接口有订阅和解除订阅的方法，供其他类调用，还有一个通知订阅类的方法，每次状态发生变化时，调用该方法，向记录的已经订阅的类去传递消息；另一个是Observer接口，对应需要响应Subject的类，该接口只有一个更新的方法，供Subject通知时调用。</p>
<p>​    观察者模式有什么好处呢？首先我们容易想到，它降低了类之间的<strong>耦合</strong>。我们之前的代码在增加或减少需要获取信息的类时，需要具体去改变产生信息的中心类的代码，而使用观察者模式，我们仅需要调用Subject的一个方法即可，并不会改变Subject本身，使系统具有更大弹性。</p>
<p>​    当然，我们上述的模型是一个<strong>“推式”</strong>的模型，由Subject主动向Observer通知变化。我们也很容易可以实现一个<strong>“拉式”</strong>的模型，由Observer在需要时向Subject拉取数据。</p>
<p>​    观察者模式在很多框架或者库中都有影子，如果你写过GUI或是用JavaScript写过Web界面，那你一定不会对<strong>事件</strong>这个概念陌生。如在JavaScript中，我们要添加一个按钮，在按下按钮时调用一个函数，我们就需要把按下按钮这个事件与需要执行的函数<strong>绑定</strong>，这样一个过程实际上就是观察者模式中Observer向Subject注册的过程。我们很容易体会这种方式的优越性，它把事件与响应之间的耦合降到了最低，我们为一个事件实现不同的响应时并不需要修改事件本身的代码。</p>
</div><div class="post-copyright"><blockquote><p>Original author: 马旭</p><p>Original link: <a href="https://bhmaxu.github.io/2020/02/10/设计模式（1）/">https://bhmaxu.github.io/2020/02/10/设计模式（1）/</a></p><p>Copyright Notice: Please indicate the source of the reprint (must retain the author's signature and link)</p></blockquote></div><div class="tags"><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></div><div class="post-share"><div class="social-share"><span>Share:</span></div></div><div class="post-nav"><a href="/2020/02/11/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%882%EF%BC%89/" class="pre">设计模式（2）</a><a href="/2020/02/10/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%889%EF%BC%89-%E9%93%BE%E8%B7%AF%E5%B1%82/" class="next">计算机网络（9）-链路层</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">Contents</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#设计模式的意义"><span class="toc-text">设计模式的意义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#策略模式（Strategy-Pattern）"><span class="toc-text">策略模式（Strategy Pattern）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#观察者模式（Observer-Pattern）"><span class="toc-text">观察者模式（Observer Pattern）</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/04/03/%E5%85%B3%E4%BA%8Ework-life-balance%E7%9A%84%E6%84%9F%E6%83%B3/">关于work-life balance的感想</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/31/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%884%EF%BC%89/">Java多线程（4）</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/22/java%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%883%EF%BC%89/">java多线程（3）</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/16/java%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%882%EF%BC%89/">java多线程（2）</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/16/java%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%881%EF%BC%89/">java多线程（1）</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/05/%E7%96%AB%E6%83%85%E6%9C%9F%E9%97%B4%E7%9A%84%E8%87%AA%E6%88%91%E5%8F%8D%E6%80%9D/">疫情期间的自我反思</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%8810%EF%BC%89-%E5%B1%80%E5%9F%9F%E7%BD%91/">计算机网络（10）-局域网</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/11/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%882%EF%BC%89/">设计模式（2）</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/10/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%881%EF%BC%89/">设计模式（1）</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/10/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%889%EF%BC%89-%E9%93%BE%E8%B7%AF%E5%B1%82/">计算机网络（9）-链路层</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> Tags</i></div><div class="tagcloud"><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 15px;">计算机网络</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 15px;">设计模式</a> <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 15px;">多线程</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> Archive</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">18</span></li></ul></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Site Map</a> |  <a href="/atom.xml">Subscribe to this site</a> |  <a href="/about/">Contact the blogger</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">马旭.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/" target="_blank" rel="noopener"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.4"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});</script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML" async></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.4" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script></body></html>